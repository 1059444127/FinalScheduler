<#include "../common/_contentHeader.html"/>
<@layout title="班次设置"/>
<div class="table_box">
	<table class="table table-hover">
		<tbody>
			<tr>
				<th width="4%">pid</th>
				<th width="35%">标题</th>
				<th width="12%">操作</th>
			</tr>
			<#list planPage.getList() as x>
			<tr>
				<td style="text-align:left;">${x.pid}</td>
				<td style="text-align:left;">${x.planName}</td>
				<td style="text-align:left;">
					&nbsp;&nbsp;<a href="#delModal" data-toggle="modal" onclick="setPlanDelPid(${x.pid})">删除</a>
					&nbsp;&nbsp;<a href="./plan/edit/${x.pid}">修改</a>
				</td>
			</tr>
			</#list>
		</tbody>
	</table>
	<#include "../common/_paginate.html" />
	<@paginate currentPage=planPage.pageNumber totalPage=planPage.totalPage actionUrl="plan" ui="WEB-INF/views/planset/plan.html" />
</div>
<div class="modal small fade" id="delModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">删除确认</h3>
        </div>
        <div class="modal-body">
            <p class="error-text"><i class="fa fa-warning modal-icon"></i>确定想要删除此记录吗?<br>这是不可恢复的操作.</p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-default" data-dismiss="modal" aria-hidden="true">取消</button>
            <button class="btn btn-danger" data-dismiss="modal" onclick="delPlan();">删除</button>
        </div>
      </div>
    </div>
</div>
<script type="text/javascript">
	var delPlanPid="";
	function delPlan(){
		gcGet('./plan/delete/'+delPlanPid);
		// $("#delModal").modal('hide');
		//需要手动隐藏，不解。。
		$(".modal-backdrop").hide();
		seajs.use('app/planset/index',function(plan){
			plan.refresh();
		});
	}
	function setPlanDelPid(pid){
		delPlanPid=pid;
	}
</script>